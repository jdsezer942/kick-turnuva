<!DOCTYPE html>
<html><body><p>Giriş tamamlanıyor...</p>
<script>
const params = new URLSearchParams(location.search);
const code = params.get('code');
const state = params.get('state');

if (state !== localStorage.getItem('kick_state')) {
  alert('Güvenlik hatası'); history.back();
}

if (code) {
  fetch('https://id.kick.com/oauth/token', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({
      grant_type: 'authorization_code',
      client_id: '01KHSMYKTDM9DD6Y4HHBV0RYSB',
      client_secret: 'b089747d86bf523272990a3b9c9108b7d002ee0cd928fba42dd2104a4e7fe57e',
      code,
      redirect_uri: 'https://jdsezer942.github.io/kick-turnuva/callback.html',
      code_verifier: localStorage.getItem('kick_verifier')
    })
  })
  .then(r => r.json())
  .then(data => {
    if (data.access_token) {
      localStorage.setItem('kick_token', data.access_token);
      location.href = 'https://jdsezer942.github.io/kick-turnuva/';
    } else alert('Token hatası: ' + data.error);
  })
  .catch(e => alert('Hata: ' + e));
} else alert('Code alınamadı');
</script></body></html>

