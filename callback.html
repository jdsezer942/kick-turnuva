<!DOCTYPE html>
<html lang="tr">
<head><meta charset="UTF-8"><title>Giriş Tamamlanıyor...</title></head>
<body style="background:#111;color:#fff;text-align:center;padding:50px;">
  <p>Giriş tamamlanıyor, lütfen bekle...</p>

<script>
const CLIENT_ID = "01KHSMYKTDM9DD6Y4HHBV0RYSB";
const CLIENT_SECRET = "b089747d86bf523272990a3b9c9108b7d002ee0cd928fba42dd2104a4e7fe57e"; // senin secret
const REDIRECT_URI = "https://jdsezer942.github.io/kick-turnuva/callback.html";

const params = new URLSearchParams(window.location.search);
const code = params.get('code');
const state = params.get('state');

if (!code || state !== localStorage.getItem('kick_state')) {
  alert("Hata oluştu. Tekrar dene.");
  window.location.href = "https://jdsezer942.github.io/kick-turnuva/";
  return;
}

fetch('https://id.kick.com/oauth/token', {
  method: 'POST',
  headers: {'Content-Type': 'application/json'},
  body: JSON.stringify({
    grant_type: 'authorization_code',
    client_id: CLIENT_ID,
    // client_secret: CLIENT_SECRET,   ← BU SATIRI YORUM YAP veya SİL
    code: code,
    redirect_uri: REDIRECT_URI,
    code_verifier: localStorage.getItem('kick_verifier')
  })
})
.then(r => r.json())
.then(data => {
  if (data.access_token) {
    localStorage.setItem('kick_token', data.access_token);
    window.location.href = "https://jdsezer942.github.io/kick-turnuva/"; // turnuva sayfası
  } else {
    alert("Token hatası: " + (data.error || "bilinmiyor"));
  }
})
.catch(() => alert("Bağlantı hatası. Tekrar dene."));
</script>
</body>
</html>

